
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Modelling Earth Processes, January practice class test 2021/2022.</title><meta name="generator" content="MATLAB 9.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-01-13"><meta name="DC.source" content="MEP_practice_test_Jan22.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Modelling Earth Processes, January practice class test 2021/2022.</h1><!--introduction--><p>Prof Jeroen van Hunen</p><p>Department of Earth Sciences</p><p>Durham University</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Test setup</a></li><li><a href="#2">Assignment</a></li><li><a href="#3">Part 1: The wave equation</a></li><li><a href="#4">Part 2: Porous media flow in 1D</a></li><li><a href="#5">Submitting your work</a></li></ul></div><h2 id="1">Test setup</h2><p>Try to do this practice test under the actual test conditions:</p><div><ul><li>Estimated completion time: 2 hours within the total time frame of 48   hours.</li><li>Allowed Resources: All teaching material available on duo, your own codes and notes,   and Matlab's help documentation, as well as internet resources.   No electronic communication (email, chats, Facebook, Zoom, and similar etc) related to this test is allowed.</li></ul></div><h2 id="2">Assignment</h2><p><b>Please read the whole test before answering any questions, and make sure you explain all your answers</b></p><h2 id="3">Part 1: The wave equation</h2><p>1. The 1-D wave equation can be written as:</p><p><img src="MEP_practice_test_Jan22_eq14860095006708900869.png" alt="$\displaystyle \frac{\partial^2 u}{\partial t^2} = v^2 \frac{\partial^2 u}{\partial z^2}$" style="width:62px;height:25px;">,</p><p>in which <img src="MEP_practice_test_Jan22_eq15012583454694319273.png" alt="$u$" style="width:6px;height:6px;"> is the displacement, <img src="MEP_practice_test_Jan22_eq10146963226942718528.png" alt="$t$" style="width:4px;height:8px;"> is time, <img src="MEP_practice_test_Jan22_eq03267610581743698706.png" alt="$z$" style="width:5px;height:6px;"> is the spatial coordinate, and <img src="MEP_practice_test_Jan22_eq10084146807967347884.png" alt="$v$" style="width:5px;height:6px;"> is the constant wave speed. This equation is applied to an equidistant 5-point grid with essential boundary conditions u=0 on either end. Write out a) the backward Euler discretisation of this equation, and b) provide the matrix-vector system of equations that is needed to solve for the displacement at timestep <img src="MEP_practice_test_Jan22_eq06671788856257458288.png" alt="$n+1$" style="width:25px;height:9px;"> if the solution for all previous timesteps (<img src="MEP_practice_test_Jan22_eq17555110721583917243.png" alt="$n$" style="width:7px;height:6px;">, <img src="MEP_practice_test_Jan22_eq05403455565168925733.png" alt="$n-1$" style="width:25px;height:8px;">, <img src="MEP_practice_test_Jan22_eq04500634722363094346.png" alt="$n-2$" style="width:25px;height:8px;"> etc.) are all known.</p><p>2. When an earthquake hits a skyscraper, a seismic 'wave' will travel through the building. a) Assuming we could model this with the 1-D vertical wave equation, what would be a suitable boundary condition for the top of the building?</p><p>b) If the amplitude of the 'wave' is 10 cm, what would be the displacement felt by a person standing on top of the skyscraper at the moment that the wave hits the top of the building? You could check your answer by looking at the results from your 1-D Matlab code from week 12.</p><p>3. Write out the 2-D equivalent of the wave equation given in question 1, and discretize it with the Forward Euler discretisation, assuming the seismic wave velocity is equal in both directions, and the grid spacing in both directions is <img src="MEP_practice_test_Jan22_eq05864451332169676493.png" alt="$\Delta x = \Delta z = \Delta$" style="width:68px;height:9px;">. Write your answer in the simplest possible form.</p><h2 id="4">Part 2: Porous media flow in 1D</h2><p>Assume a horizontal 1-D porous medium of <img src="MEP_practice_test_Jan22_eq03997557557918356741.png" alt="$w=400$" style="width:39px;height:8px;"> m wide. Fluid flow through the pores is based on Darcy&#146;s law, and, in the presence of a spatially varying fluid source/sink <img src="MEP_practice_test_Jan22_eq10879027105837505533.png" alt="$H$" style="width:10px;height:8px;">, can be described by the following d.e.:</p><p><img src="MEP_practice_test_Jan22_eq13988367101708639072.png" alt="$\displaystyle \frac{\partial P}{\partial t} =   \frac{k}{\phi \beta \eta}     \left(\frac{\partial^2 P}{\partial x^2}     \right) + \frac{H}{\beta \phi}$" style="width:122px;height:28px;"></p><p>in 1-D, where <img src="MEP_practice_test_Jan22_eq14927246206938046595.png" alt="$P$" style="width:9px;height:8px;"> is the (non-hydrostatic) pressure, <img src="MEP_practice_test_Jan22_eq08120704938398221181.png" alt="$k=10^{-12}$" style="width:45px;height:10px;"> <img src="MEP_practice_test_Jan22_eq06434714606596009170.png" alt="$\mathrm{m^2}$" style="width:13px;height:10px;"> the rock permeability, <img src="MEP_practice_test_Jan22_eq07362383595829720611.png" alt="$\phi=0.05$" style="width:40px;height:10px;"> is the porosity, <img src="MEP_practice_test_Jan22_eq12441496468145278350.png" alt="$\beta=10^{-8}$" style="width:43px;height:12px;"> <img src="MEP_practice_test_Jan22_eq17714393970272015166.png" alt="$\mathrm{Pa^{-1}}$" style="width:22px;height:10px;"> the fluid compressibility, and <img src="MEP_practice_test_Jan22_eq05102749176646083286.png" alt="$\eta=10^{-4}$" style="width:41px;height:12px;"> Pa s the fluid viscosity, and <img src="MEP_practice_test_Jan22_eq12829740475467572519.png" alt="$k$" style="width:6px;height:8px;">, <img src="MEP_practice_test_Jan22_eq16179117359969153947.png" alt="$\phi$" style="width:6px;height:10px;">, <img src="MEP_practice_test_Jan22_eq05794602797221842019.png" alt="$\beta$" style="width:7px;height:10px;">, and <img src="MEP_practice_test_Jan22_eq00747499779863439571.png" alt="$\eta$" style="width:6px;height:8px;"> are all constants. The model has a zero pore pressure everywhere at time <img src="MEP_practice_test_Jan22_eq00402237798869806649.png" alt="$t=0$" style="width:24px;height:8px;">, and has fixed pressure essential boundary conditions <img src="MEP_practice_test_Jan22_eq14097848996521265619.png" alt="$P=0$" style="width:29px;height:8px;"> Pa on both boundaries.</p><p>The source/sink term <img src="MEP_practice_test_Jan22_eq10879027105837505533.png" alt="$H$" style="width:10px;height:8px;"> is zero everywhere, except for the following point source <img src="MEP_practice_test_Jan22_eq06744575890974359400.png" alt="$H = H_{src} =$" style="width:56px;height:10px;"> 1 <img src="MEP_practice_test_Jan22_eq17052437530630864149.png" alt="$\mathrm{m/sec}$" style="width:29px;height:11px;"> at <img src="MEP_practice_test_Jan22_eq13044165209533756220.png" alt="$\displaystyle x = \frac{w}{2}$" style="width:31px;height:20px;">. In other words, a '1-D volume' of 1 m/s of fluid is continuously entering the middle of the domain.</p><p>4. Describe in words and with a sketch how you think the pressure distribution will evolve in the model. Do you think the model will approach a steady-state solution?</p><p>5. Build a Matlab code for the porous media flow model described above. It is probably easiest to build this code from one of the existing codes that you built previously or are available in the MEP model answers. [a fully working, well written and documented code would give full marks, but in case you cannot create a working code in time, make sure to describe the approach you took or were planning to take, and where the problem with implementation lies].</p><h2 id="5">Submitting your work</h2><p>a) As this is a practice test, and model answers are available for you to    check, there is no need to submit your answers. But if you have any questions    that are not covered in the model answers, feel free to email me at <a href="mailto:jeroen.van-hunen@durham.ac.uk">jeroen.van-hunen@durham.ac.uk</a></p><p>b) Similarly, if your Matlab code of Question 5 doesn't work, and you cannot    figure out why, or you have any other questions about your code, you can email it to me.</p><p>Keep in mind that, in order to get a maximum amount of marks for your code, it should have:</p><div><ul><li>A clear structure</li><li>Logical variable names</li><li>Sufficient comments</li></ul></div><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Modelling Earth Processes, January practice class test 2021/2022.
% 
% Prof Jeroen van Hunen
%
% Department of Earth Sciences
%
% Durham University
%
%% Test setup
% 
% Try to do this practice test under the actual test conditions: 
% 
% * Estimated completion time: 2 hours within the total time frame of 48
%   hours.
% * Allowed Resources: All teaching material available on duo, your own codes and notes, 
%   and Matlab's help documentation, as well as internet resources.
%   No electronic communication (email, chats, Facebook, Zoom, and similar etc) related to this test is allowed.
%
%% Assignment
% *Please read the whole test before answering any questions, and make 
% sure you explain all your answers*
%
%% Part 1: The wave equation
% 1. The 1-D wave equation can be written as:
% 
% $\displaystyle \frac{\partial^2 u}{\partial t^2} = v^2 \frac{\partial^2
% u}{\partial z^2}$, 
% 
% in which $u$ is the displacement, $t$ is time, $z$
% is the spatial coordinate, and $v$ is the constant wave speed. 
% This equation is applied to an equidistant 5-point grid
% with essential boundary conditions u=0 on either end. 
% Write out a) the backward Euler discretisation of this equation, and b) provide
% the matrix-vector system of equations that is needed to solve for the
% displacement at timestep $n+1$ if the solution for all previous timesteps
% ($n$, $n-1$, $n-2$ etc.) are all known.
% 
% 2. When an earthquake hits a skyscraper, a seismic 'wave' will travel through the building. 
% a) Assuming we could model this with the 1-D vertical wave equation, what would
% be a suitable boundary condition for the top of the building? 
% 
% b) If the amplitude of the 'wave' is 10 cm, what would be the displacement felt by
% a person standing on top of the skyscraper at the moment that the wave
% hits the top of the building? You could check your answer by looking at
% the results from your 1-D Matlab code from week 12.
% 
% 3. Write out the 2-D equivalent of the wave equation given in question 1,
% and discretize it with the Forward Euler discretisation, assuming the seismic 
% wave velocity is equal in both directions, and the grid spacing in both directions 
% is $\Delta x = \Delta z = \Delta$. Write your answer in the simplest
% possible form.
% 
%% Part 2: Porous media flow in 1D
%
% Assume a horizontal 1-D porous medium of $w=400$ m wide. 
% Fluid flow through the pores is based on
% DarcyÂ’s law, and, in the presence of a spatially varying fluid source/sink $H$,
% can be described by the following d.e.:
% 
% $\displaystyle \frac{\partial P}{\partial t} = 
%   \frac{k}{\phi \beta \eta}
%     \left(\frac{\partial^2 P}{\partial x^2}
%     \right) + \frac{H}{\beta \phi}$
% 
% in 1-D, where $P$ is the (non-hydrostatic) pressure, 
% $k=10^{-12}$ $\mathrm{m^2}$ the rock permeability, 
% $\phi=0.05$ is the porosity, 
% $\beta=10^{-8}$ $\mathrm{Pa^{-1}}$ the fluid compressibility, and 
% $\eta=10^{-4}$ Pa s the fluid viscosity, and $k$, $\phi$, $\beta$, and $\eta$ are all constants.
% The model has a zero pore pressure everywhere at time $t=0$, and 
% has fixed pressure essential boundary conditions $P=0$ Pa on both boundaries.
% 
% The source/sink term $H$ is zero everywhere, except for the following
% point source $H = H_{src} =$ 1 $\mathrm{m/sec}$ at $\displaystyle x = \frac{w}{2}$.
% In other words, a '1-D volume' of 1 m/s of fluid is continuously entering 
% the middle of the domain.
% 
% 4. Describe in words and with a sketch how you think the pressure distribution will evolve in 
% the model. Do you think the model will approach a steady-state solution?
% 
% 5. Build a Matlab code for the porous media flow model described above.
% It is probably easiest to build this code from one of the existing codes
% that you built previously or are available in the MEP model answers.
% [a fully working, well written and documented code would give full marks, 
% but in case you cannot create a working code in time, make sure to describe 
% the approach you took or were planning to take, and where the problem with implementation lies]. 
%
%% Submitting your work
% 
% a) As this is a practice test, and model answers are available for you to 
%    check, there is no need to submit your answers. But if you have any questions 
%    that are not covered in the model answers, feel free to email me at jeroen.van-hunen@durham.ac.uk
% 
% b) Similarly, if your Matlab code of Question 5 doesn't work, and you cannot 
%    figure out why, or you have any other questions about your code, you can email it to me. 
% 
% Keep in mind that, in order to get a maximum amount of marks for your code, it should have: 
% 
% * A clear structure
% * Logical variable names
% * Sufficient comments
##### SOURCE END #####
--></body></html>