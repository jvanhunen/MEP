
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Modelling Earth Processes - Model answers to the summative class test Friday 19th November 2021</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="https://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-12-01"><meta name="DC.source" content="MEP_test_Nov21_model_answers.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Modelling Earth Processes - <b>Model answers to the</b> summative class test Friday 19th November 2021</h1><!--introduction--><p><b>Model answers in bold</b></p><p>Prof Jeroen van Hunen</p><p>Department of Earth Sciences</p><p>Durham University</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Test setup</a></li><li><a href="#2">Assignment</a></li><li><a href="#3">1. Town square flooding</a></li><li><a href="#4">2. Heat equation in cylindrical coordinates</a></li><li><a href="#5">Submitting your work</a></li></ul></div><h2 id="1">Test setup</h2><div><ul><li>Estimated completion time: 2 hours. Maximum allowed time: 4 hours</li></ul></div><div><ul><li>Submission via Ultra: a) submit your codes separately and b) submit your text   answers on paper</li><li>Allowed Resources: all teaching material available on Ultra, your own codes and notes,   Matlab's help documentation, internet sources are allowed. No (electronic   or in-person) communication (email, social media etc.)   related to the test is allowed.</li></ul></div><h2 id="2">Assignment</h2><p><b>Please read the whole test before answering any questions, and make sure you explain all your answers.</b></p><h2 id="3">1. Town square flooding</h2><p>A burst water pipe results in a town square being flooded with water at a rate of 10 litres/sec. The water spreads out over the town square, and eventually evaporates again. This evaporation rate can be assumed to be proportional to the amount of water on the square, such that every hour 1 percent of the total water volume evaporates. Furthermore assume that the town square was dry before the pipe burst.</p><p>Mathematically, this problem can be described in the form of the following differential equation: \[ \displaystyle \frac{dV}{dt} = a - bV \] in which <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02739270504201626537.png" alt="$V$"></span><script type="math/tex">V</script> is the water volume in <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq15710606425515689046.png" alt="$\mathrm{m^3}$"></span><script type="math/tex">\mathrm{m^3}</script> on the town square, <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq12656067504604335951.png" alt="$t$"></span><script type="math/tex">t</script> the time in seconds, and <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq05508344529756732484.png" alt="$a$"></span><script type="math/tex">a</script> and <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02044268985122151499.png" alt="$b$"></span><script type="math/tex">b</script> describing the water source/sink terms from the water pipe and evaporation. Your task is to build a numerical model for this problem, using the backward Euler timestepping method to calculate the water volume on the town square over a period of the first 30 days after the pipe burst.</p><p>1a. What are the values of <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq05508344529756732484.png" alt="$a$"></span><script type="math/tex">a</script> and <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02044268985122151499.png" alt="$b$"></span><script type="math/tex">b</script> for this problem and what are their (SI) units?</p><p><b>Model answer:</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04131530490201901011.png" alt="$a = 10$"></span><script type="math/tex">a = 10</script> litre/second <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02185218375604426066.png" alt="$= 0.01$"></span><script type="math/tex">= 0.01</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq12839567404316675670.png" alt="$\mathrm{m^{3}/s}$"></span><script type="math/tex">\mathrm{m^{3}/s}</script>, <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq01374775715104456033.png" alt="$b=0.01$"></span><script type="math/tex">b=0.01</script> per hour <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq08060875747852763531.png" alt="$= 0.01/60/60$"></span><script type="math/tex">= 0.01/60/60</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq08707926753867139120.png" alt="$\mathrm{s^{-1}}$"></span><script type="math/tex">\mathrm{s^{-1}}</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq15101668410968299185.png" alt="$\approx 2.7 \times 10^{-6}$"></span><script type="math/tex">\approx 2.7 \times 10^{-6}</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq08707926753867139120.png" alt="$\mathrm{s^{-1}}$"></span><script type="math/tex">\mathrm{s^{-1}}</script></p><p>1b. Write out (on paper) the backward Euler finite difference form of the    differential equation.</p><p><b>Model answer:</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq09978851167862070066.png" alt="$\displaystyle \frac{V^{i+1} - V^i}{\Delta t} = a-bV^{i+1}$"></span><script type="math/tex">\displaystyle \frac{V^{i+1} - V^i}{\Delta t} = a-bV^{i+1}</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq11206115615656929943.png" alt="$\Leftrightarrow$"></span><script type="math/tex">\Leftrightarrow</script></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04092435560491021963.png" alt="$\displaystyle V^{i+1}(1 + b\Delta t) = V^i + a \Delta t$"></span><script type="math/tex">\displaystyle V^{i+1}(1 + b\Delta t) = V^i + a \Delta t</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq11206115615656929943.png" alt="$\Leftrightarrow$"></span><script type="math/tex">\Leftrightarrow</script></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq07778003523238002142.png" alt="$\displaystyle V^{i+1}= \frac{V^i + a \Delta t}{(1 + b\Delta t)}$"></span><script type="math/tex">\displaystyle V^{i+1}= \frac{V^i + a \Delta t}{(1 + b\Delta t)}</script></p><p>1c. Produce a Matlab script that plots the solution for the problem above. In case you cannot produce a working code, write down your planned implementation of the problem.</p><p><b>A working code is provided <a href="https://blackboard.durham.ac.uk/bbcswebdav/xid-1848621_1">here</a>, and this code produces the following image (in which the curve asymptotically reaches a value of <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq00089896707194677952.png" alt="$V=3600$"></span><script type="math/tex">V=3600</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq06128523359186715658.png" alt="$\mathrm{m^{3}}$"></span><script type="math/tex">\mathrm{m^{3}}</script>):</b></p><p><img vspace="5" hspace="5" src="https://blackboard.durham.ac.uk/bbcswebdav/xid-1848620_1" alt=""> </p><p>1d. If the pipe burst would have been fixed after 10 days so that the water flow from the pipe suddenly stopped, how would you incorporate this modification into your numerical model? Describe (on paper) what changes you would need to make to your code to model this modified situation. Explain your answer.</p><p><b>The value of <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq05508344529756732484.png" alt="$a$"></span><script type="math/tex">a</script> changes from <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02185218375604426066.png" alt="$= 0.01$"></span><script type="math/tex">= 0.01</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq12839567404316675670.png" alt="$\mathrm{m^{3}/s}$"></span><script type="math/tex">\mathrm{m^{3}/s}</script> to <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq18291810376980303035.png" alt="$= 0$"></span><script type="math/tex">= 0</script> <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq12839567404316675670.png" alt="$\mathrm{m^{3}/s}$"></span><script type="math/tex">\mathrm{m^{3}/s}</script> at day 10. The simplest solution would be to build an if-statement in the time loop to set <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq15914025520652630487.png" alt="$a=0$"></span><script type="math/tex">a=0</script> if <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq08465745055820783812.png" alt="$t&gt;10$"></span><script type="math/tex">t>10</script> days.</b></p><h2 id="4">2. Heat equation in cylindrical coordinates</h2><p>The 1-D radial heat diffusion equation in cylindrical coordinates is used to describe the heat exchange between an underground water pipe and the surrounding soil.</p><p>The relevant differential equation for this problem is:   <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04558757290747020685.png" alt="$\displaystyle \frac{\partial T}{\partial t} = \frac{\kappa}{r}      \frac{\partial}{\partial r} \left(r \frac{\partial T}{\partial r}\right)$"></span><script type="math/tex">\displaystyle \frac{\partial T}{\partial t} = \frac{\kappa}{r}      \frac{\partial}{\partial r} \left(r \frac{\partial T}{\partial r}\right)</script></p><p>in which <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq14047577632175690031.png" alt="$T$"></span><script type="math/tex">T</script> is the soil temperature in degrees C, <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq16107531617707909724.png" alt="$\kappa$"></span><script type="math/tex">\kappa</script> the thermal diffusivity of the soil in m <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02702860382536398872.png" alt="$\mathrm{sec^{-2}}$"></span><script type="math/tex">\mathrm{sec^{-2}}</script>, <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04958265083611378313.png" alt="$r$"></span><script type="math/tex">r</script> the radial distance from the centre of the pipe in metres, and <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq12656067504604335951.png" alt="$t$"></span><script type="math/tex">t</script> the elapsed time in seconds.</p><p>The soil has a uniform initial temperature of 15 degrees C. At time <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq16912281546434447644.png" alt="$t=0$"></span><script type="math/tex">t=0</script>, water with a temperature of 5 degrees C starts running through the pipe.</p><p>Your task is to build a numerical model to apply this diffusion equation to model the temperature of the soil surrounding a water pipe when cold water starts running through the pipe.</p><p>Use the following model parameters:</p><div><ul><li>The pipe has a radius of <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq07763639714042422405.png" alt="$r=r_0 = 10$"></span><script type="math/tex">r=r_0 = 10</script> cm</li><li>The model will extend to <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq18359459492863466148.png" alt="$r=r_1=2$"></span><script type="math/tex">r=r_1=2</script> metres away from the pipe centre, where the   temperature will be assumed to stay fixed at 15 degrees C.</li><li>So the model domain will range from <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq08760186123981728715.png" alt="$r=0.1$"></span><script type="math/tex">r=0.1</script> m until <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq03343332144510350920.png" alt="$r=2 m$"></span><script type="math/tex">r=2 m</script>.</li><li>The thermal diffusivity of the soil is <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq00348027191971993639.png" alt="$\kappa = 10^{-6}$"></span><script type="math/tex">\kappa = 10^{-6}</script> m <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02702860382536398872.png" alt="$\mathrm{sec^{-2}}$"></span><script type="math/tex">\mathrm{sec^{-2}}</script></li></ul></div><p>Furthermore, use the following numerical parameters:</p><div><ul><li>The model uses the forward Euler time integration method.</li><li>The initial condition is a uniform <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq15810510346856658550.png" alt="$T(r,t=0)=15$"></span><script type="math/tex">T(r,t=0)=15</script> degrees C.</li><li>Boundary conditions are <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq11133585649950605508.png" alt="$T(r=r_0,t)=5$"></span><script type="math/tex">T(r=r_0,t)=5</script> degrees C and <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq06426354089586164396.png" alt="$T(r=r_1,t)=15$"></span><script type="math/tex">T(r=r_1,t)=15</script> degrees C.</li><li>A constant grid spacing <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04671486709992162559.png" alt="$\Delta r = 0.1$"></span><script type="math/tex">\Delta r = 0.1</script> m.</li><li>The time step size <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq06334831050346545827.png" alt="$\Delta t = 1000$"></span><script type="math/tex">\Delta t = 1000</script> seconds.</li><li>The total model run time <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq00433066201951218143.png" alt="$t_{max}= 48$"></span><script type="math/tex">t_{max}= 48</script> hours.</li></ul></div><p>Figure 1 illustrates the model setup.</p><p><img vspace="5" hspace="5" src="https://blackboard.durham.ac.uk/bbcswebdav/xid-1734223_1" alt=""> </p><p><i>Figure 1) Illustration of the model setup: the task in this exercise is to build a 1-D radial thermal diffusion model (black line) through the soil (grey) that extends from <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq00151314831625157287.png" alt="$r=r_0$"></span><script type="math/tex">r=r_0</script> to <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq01301480738557215366.png" alt="$r=r_1$"></span><script type="math/tex">r=r_1</script>.</i></p><p>2a) Show (on paper) that the forward Euler finite difference form of the    differential equation can be written as follows:    <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02301904315920462398.png" alt="$\displaystyle T_i^{j+1} = T_i^j + \frac{\kappa \Delta t}{r_i \Delta r^2}        \left( r_{i+\frac{1}{2}} (T_{i+1}^j - T_i^j) - r_{i-\frac{1}{2}} (T_i^j -        T_{i-1}^j) \right)$"></span><script type="math/tex">\displaystyle T_i^{j+1} = T_i^j + \frac{\kappa \Delta t}{r_i \Delta r^2}        \left( r_{i+\frac{1}{2}} (T_{i+1}^j - T_i^j) - r_{i-\frac{1}{2}} (T_i^j -        T_{i-1}^j) \right)</script></p><p><b>Model answer:</b> <b>Note that the <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04958265083611378313.png" alt="$r$"></span><script type="math/tex">r</script> inside the derivative does not cancel with the <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq16893079212525881268.png" alt="$1/r$"></span><script type="math/tex">1/r</script> in front of the derivative</b> <b>At point <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq05671228016298599287.png" alt="$i$"></span><script type="math/tex">i</script>, the equation discretizes as:</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq17740825488815911915.png" alt="$\displaystyle \frac{T_i^{j+1} - T_i^j}{\Delta t} = \frac{\kappa}{r_i}   \frac{\left(r \frac{\partial T}{\partial r}\right)_{i+\frac{1}{2}}       - \left(r \frac{\partial T}{\partial r}\right)_{i-\frac{1}{2}}}{\Delta r}$"></span><script type="math/tex">\displaystyle \frac{T_i^{j+1} - T_i^j}{\Delta t} = \frac{\kappa}{r_i}   \frac{\left(r \frac{\partial T}{\partial r}\right)_{i+\frac{1}{2}}       - \left(r \frac{\partial T}{\partial r}\right)_{i-\frac{1}{2}}}{\Delta r}</script></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq03068871221857390908.png" alt="$\displaystyle \Leftrightarrow \frac{T_i^{j+1} - T_i^j}{\Delta t} = \frac{\kappa}{r_i}        \frac{ r_{i+\frac{1}{2}} \frac{T_{i+1} - T_i}{\Delta r}             - r_{i-\frac{1}{2}} \frac{T_i -T_{i-1}}{\Delta r} }{\Delta r}$"></span><script type="math/tex">\displaystyle \Leftrightarrow \frac{T_i^{j+1} - T_i^j}{\Delta t} = \frac{\kappa}{r_i}        \frac{ r_{i+\frac{1}{2}} \frac{T_{i+1} - T_i}{\Delta r}             - r_{i-\frac{1}{2}} \frac{T_i -T_{i-1}}{\Delta r} }{\Delta r}</script></p><p><b>Re-arranging by putting <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq05149990902092506123.png" alt="$\Delta r$"></span><script type="math/tex">\Delta r</script>-terms together with the <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02040169822705005385.png" alt="$\displaystyle \frac{\kappa}{r_i}$"></span><script type="math/tex">\displaystyle \frac{\kappa}{r_i}</script> term, multiplying by <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq07651498126111630170.png" alt="$\Delta t$"></span><script type="math/tex">\Delta t</script> and adding <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04895878098072927983.png" alt="$T_i^j$"></span><script type="math/tex">T_i^j</script> to both sides gives the required answer.</b></p><p>2b) Write (in Matlab) a code that calculates the temperature distribution     of the soil across the model domain over 48 hours after the model start.     At every timestep, the code should produce a plot with the     temperature distribution across the model domain.     In case you cannot produce a     working code, write down your planned implementation of the problem.</p><p><b>A model answer code is available <a href="https://blackboard.durham.ac.uk/bbcswebdav/xid-1855640_1">here</a>.</b></p><p><b>The code produces the following temperature distribution after 48 hours of diffusion:</b></p><p><img vspace="5" hspace="5" src="https://blackboard.durham.ac.uk/bbcswebdav/xid-1855639_1" alt=""> </p><p>2c) Using the timestep stability criterion, derive (on paper) the maximum stable     timestep that could be used as a function of the (constant) grid spacing <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq05149990902092506123.png" alt="$\Delta r$"></span><script type="math/tex">\Delta r</script>?     Explain your answer.</p><p><b>Model answer: Assuming every <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04895878098072927983.png" alt="$T_i^j$"></span><script type="math/tex">T_i^j</script> has an associated error <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04787374840165708592.png" alt="$\epsilon_i^j$"></span><script type="math/tex">\epsilon_i^j</script>, then the discretised equation from question 2a that includes those errors can be written as:</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq03496767307926878461.png" alt="$\displaystyle (T_i^{j+1}+\epsilon_i^{j+1})  = (T_i^j+\epsilon_i^j)      + \frac{\kappa \Delta t}{r_i \Delta r^2}      \left( r_{i+\frac{1}{2}} [(T_{i+1}^j+\epsilon_{i+1}^j) - (T_i^j+\epsilon_i^j)]           - r_{i-\frac{1}{2}} [(T_i^j+\epsilon_i^j) -(T_{i-1}^j+\epsilon_{i-1}^j)] \right)$"></span><script type="math/tex">\displaystyle (T_i^{j+1}+\epsilon_i^{j+1})  = (T_i^j+\epsilon_i^j)      + \frac{\kappa \Delta t}{r_i \Delta r^2}      \left( r_{i+\frac{1}{2}} [(T_{i+1}^j+\epsilon_{i+1}^j) - (T_i^j+\epsilon_i^j)]           - r_{i-\frac{1}{2}} [(T_i^j+\epsilon_i^j) -(T_{i-1}^j+\epsilon_{i-1}^j)] \right)</script></p><p><b>Subtracting</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02301904315920462398.png" alt="$\displaystyle T_i^{j+1} = T_i^j + \frac{\kappa \Delta t}{r_i \Delta r^2}        \left( r_{i+\frac{1}{2}} (T_{i+1}^j - T_i^j) - r_{i-\frac{1}{2}} (T_i^j -        T_{i-1}^j) \right)$"></span><script type="math/tex">\displaystyle T_i^{j+1} = T_i^j + \frac{\kappa \Delta t}{r_i \Delta r^2}        \left( r_{i+\frac{1}{2}} (T_{i+1}^j - T_i^j) - r_{i-\frac{1}{2}} (T_i^j -        T_{i-1}^j) \right)</script></p><p><b>gives:</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq12373487322716935133.png" alt="$\displaystyle \epsilon_i^{j+1}  = \epsilon_i^j      + \frac{\kappa \Delta t}{r_i \Delta r^2}      \left( r_{i+\frac{1}{2}} (\epsilon_{i+1}^j - \epsilon_i^j)           - r_{i-\frac{1}{2}} (\epsilon_i^j - \epsilon_{i-1}^j) \right)$"></span><script type="math/tex">\displaystyle \epsilon_i^{j+1}  = \epsilon_i^j      + \frac{\kappa \Delta t}{r_i \Delta r^2}      \left( r_{i+\frac{1}{2}} (\epsilon_{i+1}^j - \epsilon_i^j)           - r_{i-\frac{1}{2}} (\epsilon_i^j - \epsilon_{i-1}^j) \right)</script></p><p>Assuming worst-case scenario <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq13518407809191684694.png" alt="$\epsilon_i = -\epsilon_{i-1} = -\epsilon_{i+1}$"></span><script type="math/tex">\epsilon_i = -\epsilon_{i-1} = -\epsilon_{i+1}</script>, and grouping <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq16107531617707909724.png" alt="$\kappa$"></span><script type="math/tex">\kappa</script>, <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq07651498126111630170.png" alt="$\Delta t$"></span><script type="math/tex">\Delta t</script>, and <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq05149990902092506123.png" alt="$\Delta r$"></span><script type="math/tex">\Delta r</script> into <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq06078051734278243838.png" alt="$\displaystyle R = \frac{\kappa \Delta t}{\Delta r^2}$"></span><script type="math/tex">\displaystyle R = \frac{\kappa \Delta t}{\Delta r^2}</script> gives:</p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq09027266380765962998.png" alt="$\displaystyle \epsilon_i^{j+1}  = \epsilon_i^j      - 2R \left( \frac{r_{i+\frac{1}{2}}}{r_i} + \frac{r_{i-\frac{1}{2}}}{r_i} \right) \epsilon_i^j$"></span><script type="math/tex">\displaystyle \epsilon_i^{j+1}  = \epsilon_i^j      - 2R \left( \frac{r_{i+\frac{1}{2}}}{r_i} + \frac{r_{i-\frac{1}{2}}}{r_i} \right) \epsilon_i^j</script></p><p><b>or:</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq12196438661515257864.png" alt="$\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} =    1- 2R \left( \frac{r_{i+\frac{1}{2}}}{r_i} + \frac{r_{i-\frac{1}{2}}}{r_i} \right)$"></span><script type="math/tex">\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} =    1- 2R \left( \frac{r_{i+\frac{1}{2}}}{r_i} + \frac{r_{i-\frac{1}{2}}}{r_i} \right)</script></p><p><b>In an equidistant grid, this can be written as:</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq13437506284779649086.png" alt="$\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} =    1- 2R \left( \frac{r_{i}+\frac{\Delta r}{2}}{r_i} + \frac{r_{i}-\frac{\Delta r}{2}}{r_i} \right)$"></span><script type="math/tex">\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} =    1- 2R \left( \frac{r_{i}+\frac{\Delta r}{2}}{r_i} + \frac{r_{i}-\frac{\Delta r}{2}}{r_i} \right)</script></p><p><b>The <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq05149990902092506123.png" alt="$\Delta r$"></span><script type="math/tex">\Delta r</script> terms cancel out, and the remaining <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq15663063802117552188.png" alt="$r_i$"></span><script type="math/tex">r_i</script> terms simply add up to <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq17262503285923366262.png" alt="$2$"></span><script type="math/tex">2</script>, which simplifies it to:</b></p><p><span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq10997151818399728075.png" alt="$\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} = 1- 4R$"></span><script type="math/tex">\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} = 1- 4R</script></p><p><b>To keep <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq10075380266688883277.png" alt="$\epsilon_i^{j+1}$"></span><script type="math/tex">\epsilon_i^{j+1}</script> smaller than <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq04787374840165708592.png" alt="$\epsilon_i^j$"></span><script type="math/tex">\epsilon_i^j</script> requires <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq02863842153564378278.png" alt="$-1<1-4R<1$"></span><script type="math/tex">-1<1-4R<1</script>, or <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq01992628540468371064.png" alt="$R&gt;0$"></span><script type="math/tex">R>0</script> (which it always is, since all terms in <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq03442895190380135198.png" alt="$R$"></span><script type="math/tex">R</script> are positive) and <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq15542429932132039644.png" alt="$\displaystyle R<\frac{1}{2}$"></span><script type="math/tex">\displaystyle R<\frac{1}{2}</script>. Substituting back for <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq03442895190380135198.png" alt="$R$"></span><script type="math/tex">R</script> then gives <span class="MathJax_Preview"><img src="MEP_test_Nov21_model_answers_eq00747195737804691779.png" alt="$\Delta t<\frac{\Delta r^2}{2 \kappa}$"></span><script type="math/tex">\Delta t<\frac{\Delta r^2}{2 \kappa}</script>. This is the same stability criterion as for cartesian coordinates.</b></p><h2 id="5">Submitting your work</h2><p>Before submission, please make sure that your Matlab codes:</p><div><ul><li>have a clear structure (aided by indentation and, if appropriate, the use of functions)</li><li>use logical variable names</li><li>have sufficient comments</li><li>produce clear, annotated plots</li></ul></div><p>a) Hand in your written answers. Make sure your name is written on every piece of paper that you are    handing in.</p><p>b) Submit your Matlab code (.m files) for question 1c in the Ultra assignment 'Practical Assignment 1 In-class Test (Submission Point 1)' in the 'Assessment' folder of the Modelling Earth Processes 21/22 Assessment folder on Ultra.</p><p>c) Submit your Matlab code (.m files) for question 2b in the Ultra assignment 'Practical Assignment 1 In-class Test (Submission Point 2)' in the 'Assessment' folder of the Modelling Earth Processes 21/22 Assessment folder on Ultra.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Modelling Earth Processes - *Model answers to the* summative class test Friday 19th November 2021
% *Model answers in bold*
% 
% Prof Jeroen van Hunen
%
% Department of Earth Sciences
%
% Durham University
%
%% Test setup
% 
% * Estimated completion time: 2 hours. Maximum allowed time: 4 hours
%
% * Submission via Ultra: a) submit your codes separately and b) submit your text  
%   answers on paper
% * Allowed Resources: all teaching material available on Ultra, your own codes and notes, 
%   Matlab's help documentation, internet sources are allowed. No (electronic 
%   or in-person) communication (email, social media etc.) 
%   related to the test is allowed.
%
%% Assignment
% *Please read the whole test before answering any questions, and make 
% sure you explain all your answers.*
% 
%% 1. Town square flooding
%
% A burst water pipe results in a town square being flooded with water at a 
% rate of 10 litres/sec. The water spreads out over the town square, and eventually evaporates
% again. This evaporation rate can be assumed to be proportional to the amount
% of water on the square, such that every hour 1 percent of the total water
% volume evaporates. Furthermore assume that the town square was dry before
% the pipe burst.
% 
% Mathematically, this problem can
% be described in the form of the following differential equation:
% \[ \displaystyle \frac{dV}{dt} = a - bV \]
% in which $V$ is the water volume in $\mathrm{m^3}$ on the town square, $t$ the time in seconds, 
% and $a$ and $b$ describing the water source/sink terms from the water pipe and evaporation. 
% Your task is to build a numerical model for this problem, using the backward Euler
% timestepping method to calculate the water volume on the town square over
% a period of the first 30 days after the pipe burst. 
% 
% 1a. What are the values of $a$ and $b$ for this problem and what are their (SI) units?
% 
% *Model answer:*
% 
% $a = 10$ litre/second $= 0.01$ $\mathrm{m^{3}/s}$, $b=0.01$ per hour $=
% 0.01/60/60$ $\mathrm{s^{-1}}$ $\approx 2.7 \times 10^{-6}$ $\mathrm{s^{-1}}$ 
%
% 1b. Write out (on paper) the backward Euler finite difference form of the
%    differential equation.
% 
% *Model answer:* 
%
% $\displaystyle \frac{V^{i+1} - V^i}{\Delta t} = a-bV^{i+1}$
% $\Leftrightarrow$
%
% $\displaystyle V^{i+1}(1 + b\Delta t) = V^i + a \Delta t$
% $\Leftrightarrow$
%
% $\displaystyle V^{i+1}= \frac{V^i + a \Delta t}{(1 + b\Delta t)}$
% 
% 1c. Produce a Matlab script that plots the solution for the problem
% above. In case you cannot produce a
% working code, write down your planned implementation of the problem.
% 
% *A working code is provided
% <https://blackboard.durham.ac.uk/bbcswebdav/xid-1848621_1 here>, and this
% code produces the following image (in which the curve asymptotically reaches 
% a value of $V=3600$ $\mathrm{m^{3}}$):* 
% 
% <<https://blackboard.durham.ac.uk/bbcswebdav/xid-1848620_1>>
% 
% 1d. If the pipe burst would have been fixed after 10 days so that the water 
% flow from the pipe suddenly stopped, how would you
% incorporate this modification into your numerical model? Describe (on paper) 
% what changes you would need to make to your code to model this modified
% situation. Explain your answer.
% 
% *The value of $a$ changes from $= 0.01$ $\mathrm{m^{3}/s}$ to $= 0$ $\mathrm{m^{3}/s}$ at day 10. 
% The simplest solution would be to build an if-statement in the time loop to set $a=0$ if $t>10$ days.* 
%
%% 2. Heat equation in cylindrical coordinates
% 
% The 1-D radial heat diffusion equation in cylindrical coordinates is used to
% describe the heat exchange between an underground water pipe and the
% surrounding soil.
% 
% The relevant differential equation for this problem is:
%   $\displaystyle \frac{\partial T}{\partial t} = \frac{\kappa}{r} 
%      \frac{\partial}{\partial r} \left(r \frac{\partial T}{\partial r}\right)$
%
% in which $T$ is the soil temperature in degrees C, $\kappa$ the thermal diffusivity of
% the soil in m $\mathrm{sec^{-2}}$, $r$ the radial distance from the centre of the pipe in metres, and $t$
% the elapsed time in seconds. 
%
% The soil has a uniform initial temperature of 15 degrees C. At time $t=0$, 
% water with a temperature of 5 degrees C starts running through the pipe.
%
% Your task is to build a numerical model to apply this diffusion equation 
% to model the temperature of the soil surrounding a water pipe when cold water
% starts running through the pipe. 
% 
% Use the following model parameters:
% 
% * The pipe has a radius of $r=r_0 = 10$ cm
% * The model will extend to $r=r_1=2$ metres away from the pipe centre, where the
%   temperature will be assumed to stay fixed at 15 degrees C. 
% * So the model domain will range from $r=0.1$ m until $r=2 m$.
% * The thermal diffusivity of the soil is $\kappa = 10^{-6}$ m $\mathrm{sec^{-2}}$
% 
% Furthermore, use the following numerical parameters: 
% 
% * The model uses the forward Euler time integration method.
% * The initial condition is a uniform $T(r,t=0)=15$ degrees C.
% * Boundary conditions are $T(r=r_0,t)=5$ degrees C and $T(r=r_1,t)=15$
% degrees C.
% * A constant grid spacing $\Delta r = 0.1$ m.
% * The time step size $\Delta t = 1000$ seconds.
% * The total model run time $t_{max}= 48$ hours. 
% 
% Figure 1 illustrates the model setup. 
% 
% <<https://blackboard.durham.ac.uk/bbcswebdav/xid-1734223_1>>
% 
% _Figure 1) Illustration of the model setup: the task in this exercise
% is to build a 1-D radial thermal diffusion model (black line) through the soil 
% (grey) that extends from $r=r_0$ to $r=r_1$._  
% 
% 2a) Show (on paper) that the forward Euler finite difference form of the
%    differential equation can be written as follows:
%    $\displaystyle T_i^{j+1} = T_i^j + \frac{\kappa \Delta t}{r_i \Delta r^2}
%        \left( r_{i+\frac{1}{2}} (T_{i+1}^j - T_i^j) - r_{i-\frac{1}{2}} (T_i^j -
%        T_{i-1}^j) \right)$
%
% *Model answer:* 
% *Note that the $r$ inside the derivative does not cancel with the $1/r$ in front of the derivative* 
% *At point $i$, the equation discretizes as:*
% 
% $\displaystyle \frac{T_i^{j+1} - T_i^j}{\Delta t} = \frac{\kappa}{r_i}
%   \frac{\left(r \frac{\partial T}{\partial r}\right)_{i+\frac{1}{2}} 
%       - \left(r \frac{\partial T}{\partial r}\right)_{i-\frac{1}{2}}}{\Delta r}$
% 
% $\displaystyle \Leftrightarrow \frac{T_i^{j+1} - T_i^j}{\Delta t} = \frac{\kappa}{r_i}
%        \frac{ r_{i+\frac{1}{2}} \frac{T_{i+1} - T_i}{\Delta r} 
%             - r_{i-\frac{1}{2}} \frac{T_i -T_{i-1}}{\Delta r} }{\Delta r}$
%
% *Re-arranging by putting $\Delta r$-terms together with the
% $\displaystyle \frac{\kappa}{r_i}$ term, multiplying by $\Delta t$ and
% adding $T_i^j$ to both sides gives the required answer.*
%
% 2b) Write (in Matlab) a code that calculates the temperature distribution
%     of the soil across the model domain over 48 hours after the model start.
%     At every timestep, the code should produce a plot with the
%     temperature distribution across the model domain.
%     In case you cannot produce a
%     working code, write down your planned implementation of the problem.
%
% *A model answer code is available
% <https://blackboard.durham.ac.uk/bbcswebdav/xid-1855640_1 here>.*
% 
% *The code produces the following temperature distribution after 48 hours
% of diffusion:*
% 
% <<https://blackboard.durham.ac.uk/bbcswebdav/xid-1855639_1>>
% 
% 2c) Using the timestep stability criterion, derive (on paper) the maximum stable 
%     timestep that could be used as a function of the (constant) grid spacing $\Delta r$? 
%     Explain your answer.
% 
% *Model answer: Assuming every $T_i^j$ has an associated error
% $\epsilon_i^j$, then the discretised equation from question 2a that includes those errors
% can be written as:*
% 
% $\displaystyle (T_i^{j+1}+\epsilon_i^{j+1})  = (T_i^j+\epsilon_i^j) 
%      + \frac{\kappa \Delta t}{r_i \Delta r^2}
%      \left( r_{i+\frac{1}{2}} [(T_{i+1}^j+\epsilon_{i+1}^j) - (T_i^j+\epsilon_i^j)] 
%           - r_{i-\frac{1}{2}} [(T_i^j+\epsilon_i^j) -(T_{i-1}^j+\epsilon_{i-1}^j)] \right)$
% 
% *Subtracting*
% 
% $\displaystyle T_i^{j+1} = T_i^j + \frac{\kappa \Delta t}{r_i \Delta r^2}
%        \left( r_{i+\frac{1}{2}} (T_{i+1}^j - T_i^j) - r_{i-\frac{1}{2}} (T_i^j -
%        T_{i-1}^j) \right)$
% 
% *gives:*
% 
% $\displaystyle \epsilon_i^{j+1}  = \epsilon_i^j
%      + \frac{\kappa \Delta t}{r_i \Delta r^2}
%      \left( r_{i+\frac{1}{2}} (\epsilon_{i+1}^j - \epsilon_i^j) 
%           - r_{i-\frac{1}{2}} (\epsilon_i^j - \epsilon_{i-1}^j) \right)$
% 
% Assuming worst-case scenario $\epsilon_i = -\epsilon_{i-1} =
% -\epsilon_{i+1}$, and grouping $\kappa$, $\Delta t$, and $\Delta r$ into
% $\displaystyle R = \frac{\kappa \Delta t}{\Delta r^2}$ gives:
% 
% $\displaystyle \epsilon_i^{j+1}  = \epsilon_i^j
%      - 2R \left( \frac{r_{i+\frac{1}{2}}}{r_i} + \frac{r_{i-\frac{1}{2}}}{r_i} \right) \epsilon_i^j$
% 
% *or:*
%
% $\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} = 
%    1- 2R \left( \frac{r_{i+\frac{1}{2}}}{r_i} + \frac{r_{i-\frac{1}{2}}}{r_i} \right)$
% 
% *In an equidistant grid, this can be written as:*
% 
% $\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} = 
%    1- 2R \left( \frac{r_{i}+\frac{\Delta r}{2}}{r_i} + \frac{r_{i}-\frac{\Delta r}{2}}{r_i} \right)$
%
% *The $\Delta r$ terms cancel out, and the remaining $r_i$ terms simply add up to $2$, which simplifies it to:*
% 
% $\displaystyle \frac{\epsilon_i^{j+1}}{\epsilon_i^j} = 1- 4R$
% 
% *To keep $\epsilon_i^{j+1}$ smaller than $\epsilon_i^j$ requires
% $-1<1-4R<1$, or $R>0$ (which it always is, since all terms in $R$ are
% positive) and $\displaystyle R<\frac{1}{2}$. Substituting back for $R$ 
% then gives $\Delta t<\frac{\Delta r^2}{2 \kappa}$. 
% This is the same stability criterion as for cartesian coordinates.*
% 
%% Submitting your work
%
% Before submission, please make sure that your Matlab codes:
% 
% * have a clear structure (aided by indentation and, if appropriate, the use of functions)
% * use logical variable names
% * have sufficient comments
% * produce clear, annotated plots 
% 
% a) Hand in your written answers. Make sure your name is written on every piece of paper that you are
%    handing in.
% 
% b) Submit your Matlab code (.m files) for question 1c in the Ultra assignment 
% 'Practical Assignment 1 In-class Test (Submission Point 1)' 
% in the 'Assessment' folder of the Modelling Earth Processes 21/22 Assessment folder on Ultra. 
% 
% c) Submit your Matlab code (.m files) for question 2b in the Ultra assignment 
% 'Practical Assignment 1 In-class Test (Submission Point 2)' 
% in the 'Assessment' folder of the Modelling Earth Processes 21/22 Assessment folder on Ultra. 


##### SOURCE END #####
--></body></html>